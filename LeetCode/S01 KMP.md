# S01 KMP

> Author: fengclchn@outlook.com
>
> Date: 02/22/2023

[TOC]

* [代码随想录 (programmercarl.com)](https://www.programmercarl.com/0028.实现strStr.html)
* 举一个例子：要在文本串：``aabaabaafa`` 中查找是否出现过一个模式串：``aabaaf``。

![举例](https://histone-obs.obs.cn-southwest-2.myhuaweicloud.com/noteImg/KMP%E7%B2%BE%E8%AE%B21.gif)

## 前缀表

* 前缀与后缀：**前缀是指不包含最后一个字符的所有以第一个字符开头的连续子串**；**后缀是指不包含第一个字符的所有以最后一个字符结尾的连续子串**。
* 任务：前缀表的任务是当前位置匹配失败，找到之前已经匹配上的位置，再重新匹配，此也意味着在某个字符失配时，前缀表会告诉你下一步匹配中，模式串应该跳到哪个位置。
* 什么是前缀表：**记录下标i之前（包括i）的字符串中，有多大长度的相同前缀后缀。**
* 为什么使用前缀表可以告诉我们匹配失败之后跳到哪里重新匹配：**下标5之前这部分的字符串（也就是字符串aabaa）的最长相等的前缀 和 后缀字符串是 子字符串aa ，因为找到了最长相等的前缀和后缀，匹配失败的位置是后缀子串的后面，那么我们找到与其相同的前缀的后面重新匹配就可以了。**
* 前缀表具有告诉我们当前位置匹配失败，跳到之前已经匹配过的地方的能力。
* 如下图：
  * 长度为前1个字符的子串`a`，最长相同前后缀的长度为0。
  * 长度为前2个字符的子串`aa`，最长相同前后缀的长度为1。
  * 长度为前3个字符的子串`aab`，最长相同前后缀的长度为0。
  * 以此类推： 长度为前4个字符的子串`aaba`，最长相同前后缀的长度为1。 长度为前5个字符的子串`aabaa`，最长相同前后缀的长度为2。 长度为前6个字符的子串`aabaaf`，最长相同前后缀的长度为0。
  * 那么把求得的最长相同前后缀的长度就是对应前缀表的元素。

![前缀表](https://histone-obs.obs.cn-southwest-2.myhuaweicloud.com/noteImg/KMP%E7%B2%BE%E8%AE%B28.png)

* 可以看出模式串与前缀表对应位置的数字表示的就是：**下标i之前（包括i）的字符串中，有多大长度的相同前缀后缀。**

![KMP](https://histone-obs.obs.cn-southwest-2.myhuaweicloud.com/noteImg/KMP%E7%B2%BE%E8%AE%B22.gif)

* 找到的不匹配的位置， 那么此时我们要看它的前一个字符的前缀表的数值是多少。
* 为什么要前一个字符的前缀表的数值：因为**要找前面字符串的最长相同的前缀和后缀**，所以要看前一位的前缀表的数值。

## next数组

* next数组可以是前缀表，但是很多实现都是把前缀表统一减一（右移一位，初始位置为-1）之后作为next数组。
* 为什么这么做：**这并不涉及到KMP的原理，而是具体实现，next数组既可以就是前缀表，也可以是前缀表统一减一（右移一位，初始位置为-1）**